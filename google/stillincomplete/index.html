<!doctype html><html lang=en><head><title>All Accounts Takeover On Tenor Due to No Authorization Of Oauth Token üçÅ ::
0xdroopy ‚Äî Lets Hack for Good!</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Introduction # Hey, People hope you all are doing well! It is been a great time since we met through our daily blogs of my findings on certain programs. For the last three months, I have been stuck to the Google VRP and found something really interesting and critical. The reason I wanted to write about this is because of how much fun I had finding it. This was an unexpected find that caught my attention while testing one of the big acquisitions owned by Google LLC."><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://bugs.0xdroopy.live/google/stillincomplete/><link rel=stylesheet href=https://bugs.0xdroopy.live/assets/style.css><link rel=stylesheet href=https://bugs.0xdroopy.live/style.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=https://bugs.0xdroopy.live/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=https://bugs.0xdroopy.live/img/favicon.png><link href=https://bugs.0xdroopy.live/assets/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://bugs.0xdroopy.live/assets/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://bugs.0xdroopy.live/assets/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://bugs.0xdroopy.live/assets/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://bugs.0xdroopy.live/assets/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://bugs.0xdroopy.live/assets/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><meta name=twitter:card content="summary"><meta name=twitter:title content="All Accounts Takeover On Tenor Due to No Authorization Of Oauth Token üçÅ"><meta name=twitter:description content="Introduction # Hey, People hope you all are doing well! It is been a great time since we met through our daily blogs of my findings on certain programs. For the last three months, I have been stuck to the Google VRP and found something really interesting and critical. The reason I wanted to write about this is because of how much fun I had finding it. This was an unexpected find that caught my attention while testing one of the big acquisitions owned by Google LLC."><meta property="og:title" content="All Accounts Takeover On Tenor Due to No Authorization Of Oauth Token üçÅ"><meta property="og:description" content="Introduction # Hey, People hope you all are doing well! It is been a great time since we met through our daily blogs of my findings on certain programs. For the last three months, I have been stuck to the Google VRP and found something really interesting and critical. The reason I wanted to write about this is because of how much fun I had finding it. This was an unexpected find that caught my attention while testing one of the big acquisitions owned by Google LLC."><meta property="og:type" content="article"><meta property="og:url" content="https://bugs.0xdroopy.live/google/stillincomplete/"><meta property="article:section" content="google"><meta property="article:published_time" content="2022-03-12T00:00:00+00:00"><meta property="article:modified_time" content="2022-03-12T00:00:00+00:00"><meta property="og:site_name" content="0xdroopy"></head><body><div class=container><header class=header><span class=header__inner><a href=https://home.0xdroopy.live class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>root@0xdroopy</span>
<span class=logo__cursor></span></a>
<span class=header__right><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/bugs>post</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/bugs>post</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><div class=post><h1 class=post-title>All Accounts Takeover On Tenor Due to No Authorization Of Oauth Token üçÅ</h1><div class=post-meta><span class=post-date>2022-03-12</span>
<span class=post-author>‚Äî Written by 0xdroopy</span></div><div class=post-content><h2 id=introduction>Introduction
<a href=#introduction class=h-anchor aria-hidden=true>#</a></h2><img src=https://www.teahub.io/photos/full/106-1060107_famous-paintings-of-the-renaissance-wallpaper-school-of.jpg alt="Hello Friend" class=center style=border-radius:8px><p>Hey, People hope you all are doing well! It is been a great time since we met through our daily blogs of my findings on certain programs. For the last three months, I have been stuck to the Google VRP and found something really interesting and critical. The reason I wanted to write about this is because of how much fun I had finding it. This was an unexpected find that caught my attention while testing one of the big acquisitions owned by Google LLC. which is a famous Gif solution named Tenor.
Please note that Tenor has passed its 6 month blackout period which is described by Google allowing it to go for monetary rewards.</p><h2 id=story>Story
<a href=#story class=h-anchor aria-hidden=true>#</a></h2><p>I was looking at one of the acquisitions owned by Google Inc. lately in 2016. After all, recognizing it as a rewardable asset, I began hunting on it. After a bit of observation, I stopped at the Oauth Flow which got my attention even more. After some requests, it came to notice for me that a serious misconfiguration is going on which was helpful for the attacker to take over every single account on tenor.com.</p><img src=https://momreadit.files.wordpress.com/2021/04/hello-garden-1.jpg alt="Hello Friend" class=center style=border-radius:8px><p>This was an unexpected as well as very interesting find and has a severe impact on the users as well as developers using it to make, upload and create awesome gifs. To exploit you should need to deep dive into the requests made during logging into the account on tenor.com using an OAuth functionality.</p><h2 id=how-oauth-flow-works>How Oauth Flow Works?
<a href=#how-oauth-flow-works class=h-anchor aria-hidden=true>#</a></h2><img src=https://developers.google.com/identity/protocols/oauth2/images/flows/authorization-code.png alt="Hello Friend" class=center style=border-radius:8px><p>Oauth is a simple functionality used in many applications to make them sign with the existing account on certain platforms. Google has one of the most famous Oauth which works in almost every application we see in our day-to-day needs. OAuth flow has a very systematic and secure way to make and create the account on specific platforms. There are many OAuth functionalities present, but here we are going to talk about the one which Tenor uses - Authorization Code.</p><h4 id=while-clicking-sign-in-with-google>While Clicking Sign In With Google
<a href=#while-clicking-sign-in-with-google class=h-anchor aria-hidden=true>#</a></h4><img src=https://i.ibb.co/Mnc9NKz/hello1.png alt="Hello Friend" class=center style=border-radius:8px>
<img src=https://i.ibb.co/gjf3Lf8/image.png alt="Hello Friend" class=center style=border-radius:10px><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-HTTP data-lang=HTTP><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>GET /o/oauth2/auth?redirect_uri=storagerelay%3A%2F%2Fhttps%2Ftenor.com%3Fid%3Dauth251216&amp;response_type=permission%20id_token&amp;scope=email%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Ftenor&amp;openid.realm=&amp;include_granted_scopes=true&amp;client_id=XXXXXXXXXXXXXXXXXXXXXX HTTP/2
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Host: accounts.google.com
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Cookie: XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:97.0) Gecko/20100101 Firefox/97.0
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Accept-Language: en-US,en;q=0.5
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Accept-Encoding: gzip, deflate
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Referer: https://tenor.com/
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Dnt: 1
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Upgrade-Insecure-Requests: 1
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Sec-Fetch-Dest: document
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Sec-Fetch-Mode: navigate
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Sec-Fetch-Site: cross-site
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Te: trailers
</span></span></span></code></pre></div><h4 id=selecting-google-account>Selecting Google Account
<a href=#selecting-google-account class=h-anchor aria-hidden=true>#</a></h4><img src=https://i.ibb.co/0QdVW6s/hello2.png alt="Hello Friend" class=center style=border-radius:8px>
<img src=https://i.ibb.co/gjf3Lf8/image.png alt="Hello Friend" class=center style=border-radius:10px><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-HTTP data-lang=HTTP><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>GET /o/oauth2/iframerpc?action=issueToken&amp;response_type=token%20id_token&amp;login_hint=AJDLj6JXrAdwGc8b9pldZZaLHnjbRv3xVIz49lxCkoyi6HA9WkOQWbSqF0MrONvcPKEhKZWphhY294SMOezVRY7_j32MAaN6SQ&amp;client_id=598652403343-harjvt5thjol9qjkrfqpmb7njrnek80v.apps.googleusercontent.com&amp;origin=https%3A%2F%2Ftenor.com&amp;scope=email%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Ftenor&amp;ss_domain=https%3A%2F%2Ftenor.com&amp;include_granted_scopes=true HTTP/2
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Host: accounts.google.com
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Cookie: __Host-GAPS=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:97.0) Gecko/20100101 Firefox/97.0
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Accept: */*
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Accept-Language: en-US,en;q=0.5
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Accept-Encoding: gzip, deflate
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>X-Requested-With: XmlHttpRequest
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Dnt: 1
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Referer: https://accounts.google.com/o/oauth2/iframe
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Sec-Fetch-Dest: empty
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Sec-Fetch-Mode: cors
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Sec-Fetch-Site: same-origin
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>Te: trailers
</span></span></span></code></pre></div><h4 id=response-from-the-server-with-a-request-of-oauth-token>Response from the server with a request of Oauth Token
<a href=#response-from-the-server-with-a-request-of-oauth-token class=h-anchor aria-hidden=true>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-http data-lang=http><span style=display:flex><span><span style=color:#a6e22e>POST</span> /keyboard.login <span style=color:#66d9ef>HTTP</span><span style=color:#f92672>/</span><span style=color:#ae81ff>1.1</span>
</span></span><span style=display:flex><span>Host<span style=color:#f92672>:</span> <span style=color:#ae81ff>api-v1.tenor.com</span>
</span></span><span style=display:flex><span>User-Agent<span style=color:#f92672>:</span> <span style=color:#ae81ff>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:97.0) Gecko/20100101 Firefox/97.0</span>
</span></span><span style=display:flex><span>Accept<span style=color:#f92672>:</span> <span style=color:#ae81ff>*/*</span>
</span></span><span style=display:flex><span>Accept-Language<span style=color:#f92672>:</span> <span style=color:#ae81ff>en-US,en;q=0.5</span>
</span></span><span style=display:flex><span>Accept-Encoding<span style=color:#f92672>:</span> <span style=color:#ae81ff>gzip, deflate</span>
</span></span><span style=display:flex><span>Referer<span style=color:#f92672>:</span> <span style=color:#ae81ff>https://tenor.com/</span>
</span></span><span style=display:flex><span>Content-Type<span style=color:#f92672>:</span> <span style=color:#ae81ff>application/x-www-form-urlencoded</span>
</span></span><span style=display:flex><span>Origin<span style=color:#f92672>:</span> <span style=color:#ae81ff>https://tenor.com</span>
</span></span><span style=display:flex><span>Content-Length<span style=color:#f92672>:</span> <span style=color:#ae81ff>997</span>
</span></span><span style=display:flex><span>Dnt<span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Sec-Fetch-Dest<span style=color:#f92672>:</span> <span style=color:#ae81ff>empty</span>
</span></span><span style=display:flex><span>Sec-Fetch-Mode<span style=color:#f92672>:</span> <span style=color:#ae81ff>cors</span>
</span></span><span style=display:flex><span>Sec-Fetch-Site<span style=color:#f92672>:</span> <span style=color:#ae81ff>same-site</span>
</span></span><span style=display:flex><span>Te<span style=color:#f92672>:</span> <span style=color:#ae81ff>trailers</span>
</span></span><span style=display:flex><span>Connection<span style=color:#f92672>:</span> <span style=color:#ae81ff>close</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>gaia_token=&lt;Oauth-Token&gt;
</span></span></code></pre></div><h2 id=whats-there-in-these-requests-to-notice>What&rsquo;s There In These Requests To Notice?
<a href=#whats-there-in-these-requests-to-notice class=h-anchor aria-hidden=true>#</a></h2><p>To further go for exploit I believe you should be aware of what&rsquo;s going on&mldr; This gives a clear vision of the vulnerability that you are about to find or are next to. Here in this OAuth Flow, there are simple and beautiful requests made between you, tenor, and accounts.google.com. First Of all, whenever the user clicks the sign in the request is taken to the Tenor. Then Tenor transfers the request from itself to Google to authorize the user with its favorable account. After that Google Authenticates the User and verifies whether the email and password are correct in its Authentication Database or not. As the authentication ends, Google sends the Oauth Token to the tenor and here the role of Google here ends. <strong>After that Tenor authorizes the OAuth token given by Google and extracts the email address from it then checks in its database and then makes the user login.</strong></p><img src=https://i.ibb.co/TK36N5P/image.png alt="Hello Friend" class=center style=border-radius:8px><p>The main thing in this whole flow that we want to notice is the point where the Tenor Authorizes the OAuth token given from Google. The OAuth token received is in the form of <code>eyj</code> format by which the Tenor extracts the email address and signs the user in the account.</p><h2 id=the-real-vulnerability>The Real Vulnerability
<a href=#the-real-vulnerability class=h-anchor aria-hidden=true>#</a></h2><img src="https://media.istockphoto.com/illustrations/night-sea-after-storm-with-sailboat-painting-illustration-id473421132?k=20&m=473421132&s=612x612&w=0&h=ZGEUa6fA6cTja7LwuE4jEHacOjEZdel6jDl4QRgX2DA=" alt="Hello Friend" class=center style=border-radius:8px><p>In this lovely and enjoyable process of OAuth, there is something that goes very wrong at tenor.com. The Backend API fails to authorize the OAuth token which was provided by the <strong>Google</strong> by which we could authorize the tokens from the third-party platforms. What does that third party mean? Does it refer that what if we take the token from another website and use it here? This makes everything very critical as almost every company uses the OAuth functionality to make its users get signed in to its platform. And also these companies store the Access Tokens as well. Now Suppose if an account is created on tenor.com and then it is created on a third party app then the third party app would be able to take over the account successfully. By this, it turns out to be a major threat as anyone can make a website where they allow OAuth authentication and then they could use the token which they received from the user.</p><h2 id=the-conclusion>The Conclusion!
<a href=#the-conclusion class=h-anchor aria-hidden=true>#</a></h2><img src=https://media.makeameme.org/created/one-does-not-5b6956.jpg alt="Hello Friend" class=center style=border-radius:8px><h2 id=timeline>Timeline:
<a href=#timeline class=h-anchor aria-hidden=true>#</a></h2><p>[Dec 24, 2021] - Bug reported</p><p>[Dec 24, 2021] - Initial triage</p><p>[Dec 24, 2021] - Bug accepted (P4 -> P2)</p><p>[Jan 02, 2022] -</p><p>[Jan 14, 2022] -</p></div></div></div><footer class=footer><div class=footer__inner><a href=https://home.0xdroopy.live class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>root@0xdroopy</span>
<span class=logo__cursor></span></a><div class=copyright><span>¬© 2022 Powered by
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a></span>
<span>Theme created by
<a href=https://twitter.com/panr target=_blank rel=noopener>panr</a></span></div></div></footer><script src=https://bugs.0xdroopy.live/assets/main.js></script>
<script src=https://bugs.0xdroopy.live/assets/prism.js></script></div></body></html>